# WVOID-FM

A 24/7 AI-powered internet radio station. Claude writes the DJ scripts, Chatterbox speaks them, and the stream runs forever.

## What is this?

WVOID-FM is an experimental radio station where:
- Music is curated by time of day (late night jazz, morning ambient, afternoon energy)
- A mysterious DJ called "The Liminal Operator" speaks between tracks
- DJ scripts are generated by Claude, rendered to speech by Chatterbox TTS
- Listeners can send messages that get read on air

**Live stream:** [radio.khaledeltokhy.com](https://radio.khaledeltokhy.com)

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                         Mac Host                             │
├─────────────────────────────────────────────────────────────┤
│  stream_gapless.py                                          │
│    ├── Curates music queue by time period                   │
│    ├── Selects DJ segments (prioritizes listener messages)  │
│    ├── Pipes PCM audio to ffmpeg encoder                    │
│    └── Streams to Icecast                                   │
├─────────────────────────────────────────────────────────────┤
│  Icecast :8000 ──► Cloudflare Tunnel ──► radio.example.com  │
│  API :8001 ──────► Cloudflare Tunnel ──► api.example.com    │
├─────────────────────────────────────────────────────────────┤
│  content_generator/                                         │
│    ├── headless_dj_generator.py  (Claude + Chatterbox)      │
│    └── dedication_processor.py   (listener message → audio) │
└─────────────────────────────────────────────────────────────┘
```

## Quick Start

### 1. Install dependencies

```bash
# Install uv (Python package manager)
curl -LsSf https://astral.sh/uv/install.sh | sh

# Install system dependencies (macOS)
brew install icecast ffmpeg

# Set up Python environment
uv sync

# Set up Chatterbox TTS
cd mac/chatterbox
uv venv --python 3.11
uv pip install chatterbox-tts torch torchaudio
```

### 2. Configure

```bash
# Copy example configs
cp config/icecast.xml.example config/icecast.xml
cp mac/config.yaml.example mac/config.yaml

# Edit with your settings
# - Add music source directories
# - Set Icecast passwords
# - Configure tunnel (optional)
```

### 3. Add music

Put your audio files (mp3, flac, m4a, wav) in directories listed in `mac/config.yaml`.

### 4. Add a voice reference (optional)

For voice cloning, add a 10-30 second WAV file of the voice you want:
```bash
cp your_voice.wav mac/voice_reference/operator_voice.wav
```

### 5. Start streaming

```bash
# Start Icecast
brew services start icecast

# Start the streamer
cd mac
uv run python stream_gapless.py

# In another terminal, start the API server
uv run python now_playing_server.py
```

### 6. Generate DJ segments

```bash
cd mac/content_generator
uv run python headless_dj_generator.py --count 20
```

## Time Periods

The station automatically adjusts its mood throughout the day:

| Period | Hours | Energy | Vibe |
|--------|-------|--------|------|
| late_night | 00-05 | 0.2-0.4 | Ambient, drone, minimal |
| early_morning | 05-08 | 0.3-0.5 | Warm, gentle wakeup |
| morning | 08-12 | 0.5-0.7 | Building energy |
| afternoon | 12-17 | 0.6-0.8 | Peak energy |
| evening | 17-21 | 0.5-0.7 | Winding down |
| night | 21-00 | 0.3-0.5 | Contemplative |

## Segment Types

The DJ generates various segment types with different purposes:

- `station_id` - Short station identification
- `hour_marker` - Acknowledges the current hour
- `song_intro` - Transitions between songs
- `dedication` - Dedicates songs to abstract concepts
- `weather` - Existential weather reports
- `monologue` - 1-2 minute philosophical rambles
- `music_history` - Deep cuts about artists/genres
- `late_night_thoughts` - Stream of consciousness
- `long_talk` - Extended 2-3 minute contemplations
- `listener_dedication` - Responses to listener messages

## Listener Messages

Listeners can send messages through the web interface. To process them:

```bash
cd mac/content_generator

# List pending messages
uv run python dedication_processor.py --list

# Process all unread messages
uv run python dedication_processor.py

# Run continuously
uv run python dedication_processor.py --daemon
```

Processed dedications are prioritized in the queue and deleted after playing.

## Operator Mode

For automated maintenance, run the operator script every few hours:

```bash
./run_operator.sh
```

Or set up a cron job:
```
0 */2 * * * /path/to/run_operator.sh
```

## Files

```
├── mac/
│   ├── stream_gapless.py      # Main streamer
│   ├── now_playing_server.py  # API server
│   ├── play_history.py        # Track history
│   ├── watchdog.py            # Process monitor
│   ├── operator_prompt.md     # Claude operator instructions
│   ├── chatterbox/            # Local TTS module
│   │   ├── tts.py
│   │   └── .venv/
│   ├── content_generator/
│   │   ├── headless_dj_generator.py
│   │   └── dedication_processor.py
│   └── voice_reference/       # Voice clone samples
├── config/
│   └── icecast.xml
├── output/
│   ├── segments/              # Generated DJ audio
│   └── scripts/               # Script metadata
└── run_operator.sh            # Operator launcher
```

## Requirements

- Python 3.11+
- ffmpeg
- Icecast2
- Claude CLI (`claude`) for script generation
- ~4GB disk for Chatterbox model
- Apple Silicon recommended for fast TTS (uses MPS)

## License

MIT
